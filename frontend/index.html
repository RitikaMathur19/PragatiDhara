<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PragatiDhara - Sustainable Route Optimization</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Google Maps Configuration -->
    <script src="config.js"></script>
    
    <!-- Google Maps JavaScript API -->
    <script>
        // Initialize Google Maps API with your API key
        function initMap() {
            console.log('üó∫Ô∏è Google Maps API loaded successfully with key:', GOOGLE_MAPS_CONFIG.API_KEY.substring(0, 10) + '...');
            window.googleMapsReady = true;
        }
        
        // Load Google Maps API using config
        (function loadGoogleMaps() {
            const apiKey = GOOGLE_MAPS_CONFIG.API_KEY;
            
            if (apiKey === 'YOUR_GOOGLE_MAPS_API_KEY_HERE') {
                console.error('‚ùå Please configure your Google Maps API key in config.js');
                return;
            }
            
            console.log('üöÄ Loading Google Maps API...');
            const script = document.createElement('script');
            script.src = `https://maps.googleapis.com/maps/api/js?key=${apiKey}&libraries=${GOOGLE_MAPS_CONFIG.LIBRARIES.join(',')}&callback=initMap`;
            script.async = true;
            script.defer = true;
            script.onerror = () => {
                console.error('‚ùå Failed to load Google Maps API - check your API key and internet connection');
            };
            document.head.appendChild(script);
        })();
    </script>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
                'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
                sans-serif;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        /* Basic utility classes similar to Tailwind */
        .min-h-screen { min-height: 100vh; }
        .bg-gradient-to-br { 
            background: linear-gradient(135deg, #f0fdf4 0%, #eff6ff 100%); 
        }
        .p-6 { padding: 1.5rem; }
        .max-w-7xl { max-width: 80rem; }
        .mx-auto { margin-left: auto; margin-right: auto; }
        .text-4xl { font-size: 2.25rem; line-height: 2.5rem; }
        .font-extrabold { font-weight: 800; }
        .text-center { text-align: center; }
        .mb-8 { margin-bottom: 2rem; }
        .text-gray-800 { color: #1f2937; }
        .grid { display: grid; }
        .lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .gap-6 { gap: 1.5rem; }
        .col-span-1 { grid-column: span 1 / span 1; }
        .p-5 { padding: 1.25rem; }
        .bg-green-50 { background-color: #f0fdf4; }
        .rounded-xl { border-radius: 0.75rem; }
        .shadow-lg { 
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05); 
        }
        .border { border-width: 1px; }
        .border-green-300 { border-color: #86efac; }
        .text-lg { font-size: 1.125rem; line-height: 1.75rem; }
        .font-bold { font-weight: 700; }
        .mb-3 { margin-bottom: 0.75rem; }
        .text-green-700 { color: #15803d; }
        .space-y-4 > * + * { margin-top: 1rem; }
        .p-3 { padding: 0.75rem; }
        .bg-green-100 { background-color: #dcfce7; }
        .rounded-lg { border-radius: 0.5rem; }
        .text-sm { font-size: 0.875rem; line-height: 1.25rem; }
        .font-semibold { font-weight: 600; }
        .text-gray-700 { color: #374151; }
        .flex { display: flex; }
        .items-center { align-items: center; }
        .flex-1 { flex: 1 1 0%; }
        .bg-gray-200 { background-color: #e5e7eb; }
        .rounded-full { border-radius: 9999px; }
        .h-2 { height: 0.5rem; }
        .mr-3 { margin-right: 0.75rem; }
        .bg-green-600 { background-color: #16a34a; }
        .transition-all { 
            transition-property: all; 
            transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1); 
            transition-duration: 500ms; 
        }
        .bg-orange-500 { background-color: #f97316; }
        .text-xs { font-size: 0.75rem; line-height: 1rem; }
        .text-gray-500 { color: #6b7280; }
        .border-t { border-top-width: 1px; }
        .pt-2 { padding-top: 0.5rem; }
        .mt-4 { margin-top: 1rem; }
        .bg-yellow-50 { background-color: #fefce8; }
        .border-yellow-300 { border-color: #fde047; }
        .text-yellow-700 { color: #a16207; }
        .mb-4 { margin-bottom: 1rem; }
        .block { display: block; }
        .text-5xl { font-size: 3rem; line-height: 1; }
        .text-yellow-600 { color: #ca8a04; }
        .my-2 { margin-top: 0.5rem; margin-bottom: 0.5rem; }
        .space-y-2 > * + * { margin-top: 0.5rem; }
        .w-full { width: 100%; }
        .p-2 { padding: 0.5rem; }
        .text-white { color: #ffffff; }
        .py-3 { padding-top: 0.75rem; padding-bottom: 0.75rem; }
        .px-4 { padding-left: 1rem; padding-right: 1rem; }
        .shadow-md { 
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06); 
        }
        .hover\\:bg-green-700:hover { background-color: #15803d; }
        .transition { 
            transition-property: color, background-color, border-color, text-decoration-color, fill, stroke, opacity, box-shadow, transform, filter, backdrop-filter;
            transition-duration: 200ms;
        }
        .justify-center { justify-content: center; }
        .w-5 { width: 1.25rem; }
        .h-5 { height: 1.25rem; }
        .mr-2 { margin-right: 0.5rem; }
        .bg-red-100 { background-color: #fee2e2; }
        .text-red-700 { color: #b91c1c; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .text-gray-600 { color: #4b5563; }
        .bg-blue-50 { background-color: #eff6ff; }
        .border-blue-300 { border-color: #93c5fd; }
        .text-blue-700 { color: #1d4ed8; }
        .bg-blue-100 { background-color: #dbeafe; }
        .text-blue-800 { color: #1e40af; }
        .text-3xl { font-size: 1.875rem; line-height: 2.25rem; }
        .text-blue-600 { color: #2563eb; }
        .mt-1 { margin-top: 0.25rem; }
        .max-h-96 { max-height: 24rem; }
        .overflow-y-auto { overflow-y: auto; }
        .mb-1 { margin-bottom: 0.25rem; }
        .border-blue-200 { border-color: #bfdbfe; }
        .bg-white { background-color: #ffffff; }
        .text-gray-800 { color: #1f2937; }
        .text-green-600 { color: #16a34a; }
        .mt-8 { margin-top: 2rem; }
        .text-2xl { font-size: 1.5rem; line-height: 2rem; }
        .mb-4 { margin-bottom: 1rem; }
        .md\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        .shadow-xl { 
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04); 
        }
        .bg-yellow-100 { background-color: #fef3c7; }
        .border-4 { border-width: 4px; }
        .border-yellow-500 { border-color: #eab308; }
        .border-green-500 { border-color: #22c55e; }
        .border-gray-300 { border-color: #d1d5db; }
        .text-xl { font-size: 1.25rem; line-height: 1.75rem; }
        .mb-2 { margin-bottom: 0.5rem; }
        .text-green-800 { color: #166534; }
        .grid-cols-2 { grid-template-columns: repeat(2, minmax(0, 1fr)); }
        .gap-2 { gap: 0.5rem; }
        .pt-3 { padding-top: 0.75rem; }
        .italic { font-style: italic; }
        .truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
        .font-medium { font-weight: 500; }

        /* Google Maps Styles */
        .map-container {
            height: 500px;
            width: 100%;
            border-radius: 0.75rem;
            overflow: hidden;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            border: 2px solid #e5e7eb;
        }
        
        .map-loading {
            display: flex;
            align-items: center;
            justify-content: center;
            height: 500px;
            background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
            font-size: 1.25rem;
            color: #6b7280;
            border-radius: 0.75rem;
        }
        
        .route-controls {
            background: white;
            border-radius: 0.75rem;
            padding: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            margin-bottom: 1rem;
        }

        /* Responsive */
        @media (min-width: 1024px) {
            .lg\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }
        @media (min-width: 768px) {
            .md\\:grid-cols-3 { grid-template-columns: repeat(3, minmax(0, 1fr)); }
        }
    </style>
</head>
<body>
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useMemo, useEffect } = React;

        // --- CORE DATA STRUCTURES (Pune, India Map Nodes) ---
        const locationLabels = {
            A: 'Katraj (South)', B: 'Swargate', C: 'Deccan Gymkhana',
            D: 'Shivajinagar', E: 'University Circle', F: 'Kothrud Bypass',
            G: 'Balewadi Stadium', H: 'Baner', I: 'Wakad', J: 'Hinjawadi Ph 1'
        };

        const staticLinks = [
            // Core Main Artery Links
            { from: 'A', to: 'B', distance: 10, time: 5 }, { from: 'A', to: 'C', distance: 12, time: 6 },
            { from: 'B', to: 'D', distance: 10, time: 5 }, { from: 'C', to: 'D', distance: 8, time: 4 },
            { from: 'D', to: 'E', distance: 5, time: 2 }, 
            { from: 'E', to: 'J', distance: 10, time: 5 }, 
            { from: 'I', to: 'J', distance: 8, time: 4 }, 

            // Eco Bypass Routes
            { from: 'C', to: 'F', distance: 8, time: 4, eco_priority: true, emissions_multiplier: 0.5 },
            { from: 'F', to: 'H', distance: 15, time: 7, eco_priority: true, emissions_multiplier: 0.05 },
            { from: 'E', to: 'I', distance: 10, time: 5, eco_priority: true, emissions_multiplier: 0.4 },
            { from: 'G', to: 'D', distance: 12, time: 5, eco_priority: true, emissions_multiplier: 0.7 },

            // Other Links
            { from: 'D', to: 'G', distance: 7, time: 3 }, 
            { from: 'G', to: 'H', distance: 5, time: 2 },
            { from: 'H', to: 'I', distance: 8, time: 4 }, 
            { from: 'D', to: 'F', distance: 12, time: 6 }, 
            { from: 'B', to: 'E', distance: 14, time: 7 }, 
        ];

        // Bidirectional link generator
        const getBidirectionalLinks = (links) => {
            const allLinks = [];
            links.forEach(link => {
                allLinks.push({ ...link });
                allLinks.push({ 
                    from: link.to, 
                    to: link.from, 
                    distance: link.distance, 
                    time: link.time, 
                    eco_priority: link.eco_priority, 
                    emissions_multiplier: link.emissions_multiplier
                });
            });
            return allLinks;
        };

        // A* pathfinding algorithm
        const findPath = (links, start, end, alpha = 1.0) => {
            const graph = {};
            links.forEach(link => {
                if (!graph[link.from]) graph[link.from] = [];
                graph[link.from].push(link);
            });

            const openSet = [{ node: start, g: 0, h: 0, f: 0, path: [start] }];
            const closedSet = new Set();

            while (openSet.length > 0) {
                openSet.sort((a, b) => a.f - b.f);
                const current = openSet.shift();

                if (current.node === end) {
                    return {
                        path: current.path,
                        totalTime: current.g,
                        totalEmissions: calculateEmissions(current.path, links)
                    };
                }

                closedSet.add(current.node);

                if (graph[current.node]) {
                    graph[current.node].forEach(link => {
                        if (closedSet.has(link.to)) return;

                        const g = current.g + link.time;
                        const emissions = link.emissions_multiplier ? 
                            link.time * 100 * link.emissions_multiplier : 
                            link.time * 100;
                        const f = g + alpha * emissions;

                        const existingNode = openSet.find(node => node.node === link.to);
                        if (!existingNode || g < existingNode.g) {
                            const newNode = {
                                node: link.to,
                                g,
                                h: 0,
                                f,
                                path: [...current.path, link.to]
                            };
                            
                            if (existingNode) {
                                const index = openSet.indexOf(existingNode);
                                openSet[index] = newNode;
                            } else {
                                openSet.push(newNode);
                            }
                        }
                    });
                }
            }

            return null;
        };

        // Calculate emissions for a path
        const calculateEmissions = (path, links) => {
            let totalEmissions = 0;
            for (let i = 0; i < path.length - 1; i++) {
                const link = links.find(l => l.from === path[i] && l.to === path[i + 1]);
                if (link) {
                    const baseEmissions = link.time * 100;
                    totalEmissions += link.emissions_multiplier ? 
                        baseEmissions * link.emissions_multiplier : 
                        baseEmissions;
                }
            }
            return Math.round(totalEmissions);
        };

        // RL agent for optimal alpha
        const calculateOptimalAlpha = (trafficFactor, incidentFactor) => {
            const baseAlpha = 1.0;
            const trafficWeight = trafficFactor * 0.5;
            const incidentWeight = incidentFactor * 0.3;
            return Math.max(0.1, Math.min(2.0, baseAlpha + trafficWeight + incidentWeight));
        };

        // Google Maps API Integration
        const GOOGLE_MAPS_API_BASE = 'http://127.0.0.1:8001/api/v1';
        
        const callGoogleMapsAPI = async (origin, destination) => {
            try {
                const payload = {
                    origin: { address: locationLabels[origin] },
                    destination: { address: locationLabels[destination] },
                    travel_mode: 'driving',
                    departure_time: new Date().toISOString(),
                    vehicle_type: selectedVehicle
                };

                console.log('üöÄ Calling Google Maps API:', payload);

                const response = await fetch(`${GOOGLE_MAPS_API_BASE}/routes/three-strategies`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept': 'application/json'
                    },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }

                const data = await response.json();
                console.log('‚úÖ Google Maps API Response:', data);
                return data;
            } catch (error) {
                console.error('‚ùå Google Maps API Error:', error);
                throw error;
            }
        };

        const checkGoogleMapsBackend = async () => {
            try {
                const response = await fetch('http://127.0.0.1:8001/health');
                const data = await response.json();
                return { connected: true, status: data.status, version: data.version };
            } catch (error) {
                return { connected: false, error: error.message };
            }
        };

        // Google Maps Component
        const GoogleMapsComponent = ({ routes, origin, destination }) => {
            const mapRef = React.useRef(null);
            const [map, setMap] = useState(null);
            const [directionsService, setDirectionsService] = useState(null);
            const [directionsRenderers, setDirectionsRenderers] = useState([]);
            
            useEffect(() => {
                if (window.google && window.google.maps && mapRef.current && !map) {
                    console.log('üó∫Ô∏è Initializing Google Maps with real API key...');
                    
                    // Initialize map using config
                    const mapInstance = new window.google.maps.Map(mapRef.current, {
                        zoom: GOOGLE_MAPS_CONFIG.DEFAULT_ZOOM,
                        center: GOOGLE_MAPS_CONFIG.DEFAULT_CENTER,
                        ...GOOGLE_MAPS_CONFIG.MAP_OPTIONS,
                    });
                    
                    // Add traffic layer for real-time traffic visualization
                    const trafficLayer = new window.google.maps.TrafficLayer();
                    trafficLayer.setMap(mapInstance);
                    
                    setMap(mapInstance);
                    setDirectionsService(new window.google.maps.DirectionsService());
                    
                    console.log('‚úÖ Google Maps initialized successfully with traffic layer');
                }
            }, [map]);
            
            // Display routes on map with waypoint markers
            useEffect(() => {
                if (map && directionsService && routes && routes.length > 0) {
                    // Clear existing renderers and markers
                    directionsRenderers.forEach(renderer => renderer.setMap(null));
                    
                    const newRenderers = [];
                    // Use colors from configuration
                    const routeColors = [
                        GOOGLE_MAPS_CONFIG.ROUTE_COLORS.fastest,
                        GOOGLE_MAPS_CONFIG.ROUTE_COLORS['eco-friendly'], 
                        GOOGLE_MAPS_CONFIG.ROUTE_COLORS.balanced
                    ];
                    const routeLabels = ['Fastest Route', 'Eco-Friendly Route', 'Balanced Route'];
                    
                    // Location coordinates mapping for Pune landmarks
                    const locationCoords = {
                        'A': { lat: 18.4682, lng: 73.8597, name: 'Katraj (South)' },
                        'B': { lat: 18.5018, lng: 73.8636, name: 'Swargate' },
                        'C': { lat: 18.5157, lng: 73.8560, name: 'Deccan Gymkhana' },
                        'D': { lat: 18.5304, lng: 73.8567, name: 'Shivajinagar' },
                        'E': { lat: 18.5090, lng: 73.8282, name: 'University Circle' },
                        'F': { lat: 18.5074, lng: 73.8077, name: 'Kothrud Bypass' },
                        'G': { lat: 18.5659, lng: 73.7717, name: 'Balewadi Stadium' },
                        'H': { lat: 18.5579, lng: 73.7804, name: 'Baner' },
                        'I': { lat: 18.5974, lng: 73.7898, name: 'Wakad' },
                        'J': { lat: 18.5912, lng: 73.7397, name: 'Hinjawadi Ph 1' }
                    };
                    
                    routes.forEach((route, index) => {
                        // Add waypoint markers for each route
                        if (route.path && route.path.length > 2) {
                            route.path.forEach((nodeId, nodeIndex) => {
                                if (nodeId !== '...' && locationCoords[nodeId]) {
                                    const coord = locationCoords[nodeId];
                                    const isStart = nodeIndex === 0;
                                    const isEnd = nodeIndex === route.path.length - 1;
                                    const isWaypoint = !isStart && !isEnd;
                                    
                                    const marker = new window.google.maps.Marker({
                                        position: coord,
                                        map: map,
                                        title: `${coord.name} (${route.type} route)`,
                                        icon: {
                                            path: window.google.maps.SymbolPath.CIRCLE,
                                            fillColor: isStart ? '#228B22' : isEnd ? '#DC143C' : routeColors[index], // Enhanced start/end colors
                                            fillOpacity: 0.9,
                                            strokeColor: 'white',
                                            strokeWeight: 3, // Thicker border for better visibility
                                            scale: isStart || isEnd ? 14 : 10, // Larger markers
                                        },
                                        label: {
                                            text: isStart ? 'START' : isEnd ? 'END' : nodeId,
                                            color: 'white',
                                            fontSize: isStart || isEnd ? '11px' : '9px',
                                            fontWeight: 'bold'
                                        },
                                        zIndex: 2000 + index // Ensure markers appear above routes
                                    });
                                    
                                    // Add info window for waypoints with route color info
                                    const routeTypeDisplay = {
                                        'fastest': 'üöÄ Fastest Route (Dark Orange)',
                                        'eco-friendly': 'üå± Eco-Friendly Route (Dark Green)', 
                                        'balanced': '‚öñÔ∏è Balanced Route (Dark Blue)'
                                    };
                                    
                                    const infoWindow = new window.google.maps.InfoWindow({
                                        content: `
                                            <div style="padding: 10px; min-width: 200px;">
                                                <h3 style="margin: 0 0 8px 0; color: ${routeColors[index]}; font-weight: bold;">
                                                    ${coord.name}
                                                </h3>
                                                <div style="margin: 5px 0;">
                                                    <span style="background: ${routeColors[index]}; color: white; padding: 2px 6px; border-radius: 3px; font-size: 11px; font-weight: bold;">
                                                        ${routeTypeDisplay[route.type]}
                                                    </span>
                                                </div>
                                                <p style="margin: 5px 0 0 0; font-size: 12px; color: #666;">
                                                    ${isStart ? 'üö© Starting Point' : 
                                                      isEnd ? 'üèÅ Destination' : 
                                                      'üìç Waypoint'}
                                                </p>
                                            </div>
                                        `
                                    });
                                    
                                    marker.addListener('click', () => {
                                        infoWindow.open(map, marker);
                                    });
                                }
                            });
                        }
                        
                        // Create directions request with waypoints
                        const waypointLocations = [];
                        if (route.waypoints && route.waypoints.length > 0) {
                            route.waypoints.forEach(nodeId => {
                                if (locationCoords[nodeId]) {
                                    waypointLocations.push({
                                        location: locationCoords[nodeId],
                                        stopover: true
                                    });
                                }
                            });
                        }
                        
                        const request = {
                            origin: locationCoords[route.path[0]] || 'Katraj, Pune, Maharashtra, India',
                            destination: locationCoords[route.path[route.path.length - 1]] || 'Hinjawadi Phase 1, Pune, Maharashtra, India',
                            waypoints: waypointLocations,
                            travelMode: window.google.maps.TravelMode.DRIVING,
                            avoidHighways: route.type === 'eco-friendly',
                            avoidTolls: route.type === 'eco-friendly',
                        };
                        
                        const renderer = new window.google.maps.DirectionsRenderer({
                            suppressMarkers: true, // We're using custom markers
                            polylineOptions: {
                                strokeColor: routeColors[index] || '#6B7280',
                                strokeOpacity: 0.9, // Higher opacity for better visibility
                                strokeWeight: 8, // Thicker lines for all routes
                                zIndex: 1000 + index, // Ensure routes appear above map elements
                            },
                            preserveViewport: index > 0, // Only first route adjusts viewport
                        });
                        
                        renderer.setMap(map);
                        newRenderers.push(renderer);
                        
                        // Get directions and display route
                        directionsService.route(request, (result, status) => {
                            if (status === 'OK') {
                                renderer.setDirections(result);
                                console.log(`‚úÖ ${route.type} route rendered successfully with ${route.waypoints?.length || 0} waypoints`);
                                
                                // Log route details for debugging
                                console.log(`üìç Route details for ${route.type}:`, {
                                    distance: result.routes[0].legs.reduce((sum, leg) => sum + leg.distance.value, 0),
                                    duration: result.routes[0].legs.reduce((sum, leg) => sum + leg.duration.value, 0),
                                    waypoints: waypointLocations.length,
                                    overview: result.routes[0].overview_polyline.points ? 'Polyline available' : 'No polyline'
                                });
                            } else {
                                console.log(`‚ùå Directions request failed for ${route.type} due to ${status}`);
                                
                                // Show user-friendly error message
                                if (status === 'REQUEST_DENIED') {
                                    console.log('üîë API Key issue - check your Google Maps API key configuration');
                                } else if (status === 'OVER_QUERY_LIMIT') {
                                    console.log('üìä API quota exceeded - check your Google Maps API usage');
                                } else {
                                    console.log(`üõ†Ô∏è Technical error: ${status}`);
                                }
                            }
                        });
                    });
                    
                    setDirectionsRenderers(newRenderers);
                }
            }, [map, directionsService, routes]);
            
            return (
                <div className="mt-6">
                    <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center">
                        üó∫Ô∏è Live Google Maps Route Visualization
                    </h3>
                    <div className="route-controls">
                        <div className="flex items-center justify-between mb-3">
                            <span className="text-sm font-semibold text-gray-700">Route Legend:</span>
                            <div className="flex gap-4 text-xs">
                                <span className="flex items-center">
                                    <div className="w-6 h-2 mr-2 border border-gray-300" style={{backgroundColor: '#FF6B00'}}></div>
                                    üöÄ <strong>Fastest (Dark Orange)</strong>
                                </span>
                                <span className="flex items-center">
                                    <div className="w-6 h-2 mr-2 border border-gray-300" style={{backgroundColor: '#006400'}}></div>
                                    üå± <strong>Eco-Friendly (Dark Green)</strong>
                                </span>
                                <span className="flex items-center">
                                    <div className="w-6 h-2 mr-2 border border-gray-300" style={{backgroundColor: '#000080'}}></div>
                                    ‚öñÔ∏è <strong>Balanced (Dark Blue)</strong>
                                </span>
                            </div>
                        </div>
                        <div className="grid grid-cols-3 gap-2 text-xs">
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-green-500 rounded-full mr-2"></div>
                                <span className="text-gray-600">Start Point</span>
                            </div>
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-blue-400 rounded-full mr-2"></div>
                                <span className="text-gray-600">Waypoints</span>
                            </div>
                            <div className="flex items-center">
                                <div className="w-3 h-3 bg-red-500 rounded-full mr-2"></div>
                                <span className="text-gray-600">Destination</span>
                            </div>
                        </div>
                        <p className="text-xs text-gray-500 mt-2 italic">
                            üí° Click on map markers to see location details and route information
                        </p>
                        {!window.google?.maps && (
                            <div className="mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
                                <p className="text-xs text-yellow-800 font-semibold mb-1">
                                    üîë Add Google Maps API Key for Full Route Visualization:
                                </p>
                                <ul className="text-xs text-yellow-700 space-y-1">
                                    <li>‚Ä¢ <strong>Real Road Routing</strong>: Actual street-by-street directions</li>
                                    <li>‚Ä¢ <strong>Turn-by-Turn Polylines</strong>: Precise route curves and paths</li>
                                    <li>‚Ä¢ <strong>Live Traffic Data</strong>: Real-time route optimization</li>
                                    <li>‚Ä¢ <strong>Accurate Distances</strong>: Precise travel times and distances</li>
                                </ul>
                            </div>
                        )}
                    </div>
                    <div className="map-container">
                        {!window.google || !window.google.maps ? (
                            <div className="map-loading">
                                <div className="text-center">
                                    <div className="text-3xl mb-3">üó∫Ô∏è</div>
                                    <div className="text-lg font-semibold">Loading Real Google Maps...</div>
                                    <div className="text-sm mt-2 text-blue-600">
                                        {window.googleMapsReady ? 
                                            'API loaded successfully! Initializing map...' : 
                                            window.google ? 
                                                'Connecting to Google Maps API...' : 
                                                'Loading Maps JavaScript API...'
                                        }
                                    </div>
                                    <div className="mt-3">
                                        <div className="animate-spin rounded-full h-6 w-6 border-2 border-blue-600 border-t-transparent mx-auto"></div>
                                    </div>
                                    <div className="text-xs text-green-600 mt-2">
                                        ‚úÖ API Key Configured Successfully
                                    </div>
                                </div>
                            </div>
                        ) : (
                            <div ref={mapRef} style={{ height: '100%', width: '100%' }}></div>
                        )}
                    </div>
                </div>
            );
        };

        const App = () => {
            // Mode toggle between RL Agent and Google Maps
            const [mode, setMode] = useState('rl'); // 'rl' or 'gmaps'
            const [gmapsBackendStatus, setGmapsBackendStatus] = useState({ connected: false, checking: true });
            
            const [startNode, setStartNode] = useState('A');
            const [endNode, setEndNode] = useState('J');
            const [results, setResults] = useState(null);
            const [message, setMessage] = useState('Configure your route and click "Plan Route"');
            const [auditLog, setAuditLog] = useState([]);
            const [loading, setLoading] = useState(false);
            
            const [selectedVehicle, setSelectedVehicle] = useState('petrol');
            
            const [rlStateVector, setRlStateVector] = useState({
                trafficFactor: 0.5,
                incidentFactor: 0.2,
                timestamp: Date.now()
            });

            const links = useMemo(() => getBidirectionalLinks(staticLinks), []);
            const optimalAlpha = useMemo(() => 
                calculateOptimalAlpha(rlStateVector.trafficFactor, rlStateVector.incidentFactor), 
                [rlStateVector]
            );

            // Check Google Maps backend status on load
            useEffect(() => {
                const checkBackend = async () => {
                    const status = await checkGoogleMapsBackend();
                    setGmapsBackendStatus({ ...status, checking: false });
                };
                checkBackend();

                // Check backend every 10 seconds
                const healthInterval = setInterval(checkBackend, 10000);

                return () => clearInterval(healthInterval);
            }, []);

            useEffect(() => {
                const interval = setInterval(() => {
                    setRlStateVector(prev => ({
                        trafficFactor: Math.max(0.1, Math.min(1.0, prev.trafficFactor + (Math.random() - 0.5) * 0.1)),
                        incidentFactor: Math.max(0.0, Math.min(1.0, prev.incidentFactor + (Math.random() - 0.5) * 0.05)),
                        timestamp: Date.now()
                    }));
                }, 3000);

                return () => clearInterval(interval);
            }, []);

            const handlePlanRoute = async () => {
                if (startNode === endNode) {
                    setMessage('Error: Start and end locations must be different');
                    return;
                }

                setLoading(true);
                const startTime = performance.now();
                
                try {
                    if (mode === 'gmaps') {
                        // Google Maps API Route
                        setMessage('üîÑ Calling Google Maps backend...');
                        const gmapsResult = await callGoogleMapsAPI(startNode, endNode);
                        
                        // Helper function to generate intermediate waypoints based on route type
                        const generateWaypoints = (routeType, start, end) => {
                            const waypointMap = {
                                'fastest': {
                                    'A-J': ['A', 'B', 'D', 'E', 'J'], // Highway route
                                    'A-I': ['A', 'B', 'D', 'G', 'H', 'I'], 
                                    'A-H': ['A', 'B', 'D', 'G', 'H'],
                                    'B-J': ['B', 'D', 'E', 'J'],
                                    'C-J': ['C', 'D', 'E', 'J'],
                                    'D-J': ['D', 'E', 'J']
                                },
                                'eco-friendly': {
                                    'A-J': ['A', 'C', 'F', 'H', 'I', 'J'], // Scenic route
                                    'A-I': ['A', 'C', 'F', 'H', 'I'],
                                    'A-H': ['A', 'C', 'F', 'H'],
                                    'B-J': ['B', 'C', 'F', 'H', 'I', 'J'],
                                    'C-J': ['C', 'F', 'H', 'I', 'J'],
                                    'D-J': ['D', 'G', 'H', 'I', 'J']
                                },
                                'balanced': {
                                    'A-J': ['A', 'B', 'D', 'G', 'H', 'I', 'J'], // Mixed route
                                    'A-I': ['A', 'C', 'D', 'G', 'H', 'I'],
                                    'A-H': ['A', 'C', 'D', 'G', 'H'],
                                    'B-J': ['B', 'D', 'G', 'H', 'I', 'J'],
                                    'C-J': ['C', 'D', 'G', 'H', 'I', 'J'],
                                    'D-J': ['D', 'G', 'H', 'I', 'J']
                                }
                            };
                            
                            const routeKey = `${start}-${end}`;
                            const reverseKey = `${end}-${start}`;
                            
                            if (waypointMap[routeType][routeKey]) {
                                return waypointMap[routeType][routeKey];
                            } else if (waypointMap[routeType][reverseKey]) {
                                return [...waypointMap[routeType][reverseKey]].reverse();
                            } else {
                                // Default path if no specific route defined
                                return [start, end];
                            }
                        };

                        // Transform Google Maps result with detailed waypoints
                        const routeResults = [
                            {
                                type: 'fastest',
                                path: generateWaypoints('fastest', startNode, endNode),
                                totalTime: Math.round(gmapsResult.routes.fastest.total_duration.value / 60),
                                totalEmissions: Math.round(gmapsResult.routes.fastest.emissions.co2_emissions_kg * 1000),
                                green_points_score: Math.round(gmapsResult.routes.fastest.emissions.eco_score * 10),
                                summary: gmapsResult.routes.fastest.summary,
                                waypoints: generateWaypoints('fastest', startNode, endNode).slice(1, -1) // Intermediate points only
                            },
                            {
                                type: 'eco-friendly',
                                path: generateWaypoints('eco-friendly', startNode, endNode),
                                totalTime: Math.round(gmapsResult.routes.eco_friendly.total_duration.value / 60),
                                totalEmissions: Math.round(gmapsResult.routes.eco_friendly.emissions.co2_emissions_kg * 1000),
                                green_points_score: Math.round(gmapsResult.routes.eco_friendly.emissions.eco_score * 10),
                                summary: gmapsResult.routes.eco_friendly.summary,
                                waypoints: generateWaypoints('eco-friendly', startNode, endNode).slice(1, -1)
                            },
                            {
                                type: 'balanced',
                                path: generateWaypoints('balanced', startNode, endNode),
                                totalTime: Math.round(gmapsResult.routes.balanced.total_duration.value / 60),
                                totalEmissions: Math.round(gmapsResult.routes.balanced.emissions.co2_emissions_kg * 1000),
                                green_points_score: Math.round(gmapsResult.routes.balanced.emissions.eco_score * 10),
                                summary: gmapsResult.routes.balanced.summary,
                                waypoints: generateWaypoints('balanced', startNode, endNode).slice(1, -1)
                            }
                        ];

                        routeResults.sort((a, b) => b.green_points_score - a.green_points_score);
                        setResults(routeResults);
                        
                        const processingTime = Math.round(performance.now() - startTime);
                        setMessage(`‚úÖ Google Maps routes calculated in ${processingTime}ms (Backend: ${gmapsResult.processing_time_ms}ms)`);
                        
                        // Add to audit log
                        const carbonSaved = routeResults.find(r => r.type === 'fastest')?.totalEmissions - 
                                          routeResults.find(r => r.type === 'eco-friendly')?.totalEmissions || 0;
                        setAuditLog(prev => [...prev, {
                            id: Date.now(),
                            rlAlpha: 'Google Maps',
                            inferenceTime: processingTime,
                            carbonSaved,
                            rlTime: routeResults.find(r => r.type === 'balanced')?.totalTime || 0,
                            fastTime: routeResults.find(r => r.type === 'fastest')?.totalTime || 0
                        }]);

                    } else {
                        // Original RL Agent Route
                        setMessage('üîÑ Running RL agent optimization...');
                        
                        const fastRoute = findPath(links, startNode, endNode, 0.1);
                        const ecoRoute = findPath(links, startNode, endNode, 2.0);
                        const rlRoute = findPath(links, startNode, endNode, optimalAlpha);

                        if (!fastRoute || !ecoRoute || !rlRoute) {
                            setMessage('Error: No valid route found');
                            return;
                        }

                        const inferenceTime = Math.round(performance.now() - startTime);
                        
                        const routeResults = [
                            {
                                type: 'fast',
                                ...fastRoute,
                                green_points_score: Math.max(0, 100 - Math.round(fastRoute.totalEmissions / 100)),
                                waypoints: fastRoute.path.slice(1, -1) // Intermediate points only
                            },
                            {
                                type: 'eco',
                                ...ecoRoute,
                                green_points_score: Math.max(0, 100 - Math.round(ecoRoute.totalEmissions / 100)) + 20,
                                waypoints: ecoRoute.path.slice(1, -1)
                            },
                            {
                                type: 'rl-optimized',
                                ...rlRoute,
                                green_points_score: Math.max(0, 100 - Math.round(rlRoute.totalEmissions / 100)) + 10,
                                waypoints: rlRoute.path.slice(1, -1)
                            }
                        ];

                        routeResults.sort((a, b) => b.green_points_score - a.green_points_score);
                        
                        setResults(routeResults);
                        setMessage(`‚úÖ RL optimization completed in ${inferenceTime}ms`);

                        const carbonSaved = fastRoute.totalEmissions - rlRoute.totalEmissions;
                        setAuditLog(prev => [...prev, {
                            id: Date.now(),
                            rlAlpha: optimalAlpha.toFixed(3),
                            inferenceTime,
                            carbonSaved,
                            rlTime: rlRoute.totalTime,
                            fastTime: fastRoute.totalTime
                        }]);
                    }

                } catch (error) {
                    setMessage(`‚ùå Error: ${error.message}`);
                    console.error('Route calculation error:', error);
                } finally {
                    setLoading(false);
                }
            };

            const totalCarbonSaved = auditLog.reduce((sum, log) => sum + Math.max(0, log.carbonSaved), 0);

            return (
                <div className="min-h-screen bg-gradient-to-br p-6">
                    <div className="max-w-7xl mx-auto">
                        <h1 className="text-4xl font-extrabold text-center mb-4 text-gray-800">
                            üå± PragatiDhara - Sustainable Route Optimization
                        </h1>

                        {/* Mode Toggle */}
                        <div className="text-center mb-6">
                            <div className="inline-flex bg-white rounded-lg p-1 shadow-lg">
                                <button
                                    onClick={() => setMode('rl')}
                                    className={`px-6 py-2 rounded-md text-sm font-medium transition ${
                                        mode === 'rl' 
                                            ? 'bg-yellow-600 text-white' 
                                            : 'text-yellow-600 hover:text-yellow-800 font-semibold'
                                    }`}
                                >
                                    üß† RL Agent Mode
                                </button>
                                <button
                                    onClick={() => setMode('gmaps')}
                                    className={`px-6 py-2 rounded-md text-sm font-medium transition ${
                                        mode === 'gmaps' 
                                            ? 'bg-blue-600 text-white' 
                                            : 'text-blue-600 hover:text-blue-800 font-semibold'
                                    }`}
                                >
                                    üåê Google Maps Mode
                                </button>
                            </div>
                        </div>

                        {/* Backend Status for Google Maps Mode */}
                        {mode === 'gmaps' && (
                            <div className="text-center mb-6">
                                <div className={`inline-flex items-center px-4 py-2 rounded-full text-sm font-medium ${
                                    gmapsBackendStatus.connected 
                                        ? 'bg-green-100 text-green-800 border border-green-200' 
                                        : gmapsBackendStatus.checking
                                            ? 'bg-yellow-100 text-yellow-800 border border-yellow-200'
                                            : 'bg-red-100 text-red-800 border border-red-200'
                                }`}>
                                    <div className={`w-2 h-2 rounded-full mr-2 ${
                                        gmapsBackendStatus.connected ? 'bg-green-500 animate-pulse' :
                                        gmapsBackendStatus.checking ? 'bg-yellow-500 animate-pulse' : 'bg-red-500'
                                    }`}></div>
                                    {gmapsBackendStatus.checking ? (
                                        'Checking Google Maps Backend...'
                                    ) : gmapsBackendStatus.connected ? (
                                        `üåø Google Maps Backend Connected ${gmapsBackendStatus.version ? `(v${gmapsBackendStatus.version})` : ''}`
                                    ) : (
                                        `‚ö° Backend Offline - ${gmapsBackendStatus.error}`
                                    )}
                                </div>
                            </div>
                        )}

                        <p className="text-lg text-gray-600 text-center mb-8">
                            {mode === 'rl' 
                                ? 'AI-powered reinforcement learning route optimization' 
                                : 'Google Maps three-route strategy with real-time data'}
                        </p>
                        
                        <div className="grid lg:grid-cols-3 gap-6 mb-8">
                            
                            {/* Traffic Data Panel */}
                            <div className="col-span-1 p-5 bg-green-50 rounded-xl shadow-lg border border-green-300">
                                <h2 className="text-lg font-bold mb-3 text-green-700">Live Traffic Intelligence</h2>
                                
                                <div className="space-y-4">
                                    <div className="p-3 bg-green-100 rounded-lg">
                                        <p className="text-sm font-semibold text-gray-700">Traffic Congestion Level</p>
                                        <div className="flex items-center">
                                            <div className="flex-1 bg-gray-200 rounded-full h-2 mr-3">
                                                <div 
                                                    className="bg-green-600 h-2 rounded-full transition-all"
                                                    style={{ width: `${rlStateVector.trafficFactor * 100}%` }}
                                                ></div>
                                            </div>
                                            <span className="text-sm font-bold">{Math.round(rlStateVector.trafficFactor * 100)}%</span>
                                        </div>
                                    </div>

                                    <div className="p-3 bg-green-100 rounded-lg">
                                        <p className="text-sm font-semibold text-gray-700">Incident Density</p>
                                        <div className="flex items-center">
                                            <div className="flex-1 bg-gray-200 rounded-full h-2 mr-3">
                                                <div 
                                                    className="bg-orange-500 h-2 rounded-full transition-all"
                                                    style={{ width: `${rlStateVector.incidentFactor * 100}%` }}
                                                ></div>
                                            </div>
                                            <span className="text-sm font-bold">{Math.round(rlStateVector.incidentFactor * 100)}%</span>
                                        </div>
                                    </div>
                                </div>
                                
                                <p className="text-xs text-gray-500 border-t pt-2 mt-4">
                                    Simulated Incident Density Factor (IDF): {rlStateVector.incidentFactor.toFixed(3)}
                                </p>
                            </div>

                            {/* RL Agent Control */}
                            <div className="col-span-1 p-5 bg-yellow-50 rounded-xl shadow-lg border border-yellow-300">
                                <h2 className="text-lg font-bold mb-3 text-yellow-700">RL Agent Inference (Œ± Action)</h2>
                                
                                <div className="mb-4">
                                    <label className="block text-sm font-semibold text-gray-700">Optimal Emissions Scale Factor (Œ±)</label>
                                    <div className="text-5xl font-extrabold text-yellow-600 my-2">{optimalAlpha.toFixed(3)}</div>
                                    <p className="text-xs text-gray-500">
                                        CPU-Optimized RL Model output based on current state.
                                    </p>
                                </div>

                                <div className="mb-4 space-y-2">
                                    <label className="block text-sm font-semibold text-gray-700">Route Points</label>
                                    <select 
                                        value={startNode} 
                                        onChange={e => setStartNode(e.target.value)} 
                                        className="w-full p-2 border rounded-lg text-sm"
                                    >
                                        {Object.keys(locationLabels).map(key => 
                                            <option key={key} value={key}>{locationLabels[key]}</option>
                                        )}
                                    </select>
                                    <select 
                                        value={endNode} 
                                        onChange={e => setEndNode(e.target.value)} 
                                        className="w-full p-2 border rounded-lg text-sm"
                                    >
                                        {Object.keys(locationLabels).map(key => 
                                            <option key={key} value={key}>{locationLabels[key]}</option>
                                        )}
                                    </select>
                                </div>

                                <div className="space-y-3">
                                    <label className="block text-sm font-semibold text-gray-700">Vehicle Type</label>
                                    <select 
                                        value={selectedVehicle} 
                                        onChange={e => setSelectedVehicle(e.target.value)} 
                                        className="w-full p-2 border rounded-lg text-sm"
                                    >
                                        <option value="petrol">Petrol Car (15 km/L)</option>
                                        <option value="diesel">Diesel Car (20 km/L)</option>
                                        <option value="cng">CNG Car (25 km/kg)</option>
                                        <option value="electric">Electric Car (5 km/kWh)</option>
                                        <option value="hybrid">Hybrid Car (25 km/L)</option>
                                    </select>
                                </div>

                                <button 
                                    onClick={handlePlanRoute} 
                                    disabled={loading || (mode === 'gmaps' && !gmapsBackendStatus.connected)}
                                    className={`w-full font-bold py-3 px-4 rounded-xl shadow-md transition ${
                                        loading || (mode === 'gmaps' && !gmapsBackendStatus.connected)
                                            ? 'bg-gray-400 text-gray-600 cursor-not-allowed' 
                                            : mode === 'gmaps'
                                                ? 'bg-blue-600 text-white hover:bg-blue-700 border-2 border-blue-700'
                                                : 'bg-green-600 text-white hover:bg-green-700'
                                    }`}
                                >
                                    <span className="flex items-center justify-center">
                                        {loading ? (
                                            <>
                                                <div className="animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent mr-2"></div>
                                                Calculating Routes...
                                            </>
                                        ) : (
                                            <>
                                                <svg className="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                                    <path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
                                                </svg>
                                                {mode === 'gmaps' ? 'Get Three Route Strategies' : 'Plan RL-Optimized Route'}
                                            </>
                                        )}
                                    </span>
                                </button>
                                
                                <div className={`p-3 rounded-xl mt-4 text-center text-sm ${
                                    message.includes('Error') ? 'bg-red-100 text-red-700' : 'bg-gray-100 text-gray-600'
                                }`}>
                                    {message}
                                </div>
                            </div>

                            {/* Audit Log */}
                            <div className="col-span-1 p-5 bg-blue-50 rounded-xl shadow-lg border border-blue-300">
                                <h2 className="text-lg font-bold mb-3 text-blue-700">Audit & Sustainability Log</h2>
                                <div className="p-3 bg-blue-100 rounded-lg mb-4 text-center">
                                    <p className="text-sm font-semibold text-blue-800">
                                        Total Cumulative Carbon Saved ({auditLog.length} requests)
                                    </p>
                                    <p className="text-3xl font-extrabold text-blue-600 mt-1">
                                        {Math.round(totalCarbonSaved / 1000).toLocaleString()} 
                                        <span className="text-sm font-semibold">kg CO‚ÇÇ</span>
                                    </p>
                                </div>
                                
                                <div className="space-y-2 max-h-96 overflow-y-auto">
                                    <p className="font-semibold text-xs text-gray-600 mb-1">Last 5 Requests:</p>
                                    {auditLog.slice(-5).reverse().map((log) => (
                                        <div key={log.id} className="p-2 border border-blue-200 rounded-lg text-xs bg-white">
                                            <p className="font-bold text-gray-800">
                                                Alpha: {log.rlAlpha} | Inf Time: {log.inferenceTime}ms
                                            </p>
                                            <p className={log.carbonSaved > 0 ? "text-green-600 font-semibold" : "text-gray-500"}>
                                                Saved: {log.carbonSaved.toLocaleString()}g CO‚ÇÇ | Cost: {log.rlTime - log.fastTime} min
                                            </p>
                                        </div>
                                    ))}
                                    {auditLog.length === 0 && (
                                        <p className="text-center text-gray-500 text-sm">Run a route to start the audit log.</p>
                                    )}
                                </div>
                            </div>
                        </div>

                        {/* Route Results */}
                        {results && (
                            <div className="mt-8">
                                <h2 className="text-3xl font-bold mb-6 text-gray-800 text-center">
                                    {mode === 'gmaps' ? 'üåê Three Google Maps Route Strategies' : 'üß† AI-Optimized Route Options'}
                                </h2>
                                
                                {mode === 'gmaps' && (
                                    <div className="text-center mb-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                                        <p className="text-blue-800 font-semibold">
                                            üöÄ <strong>Fastest:</strong> Speed-optimized with highways
                                            &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp;
                                            üå± <strong>Eco-Friendly:</strong> Environment-optimized for sustainability
                                            &nbsp;&nbsp;‚Ä¢&nbsp;&nbsp;
                                            ‚öñÔ∏è <strong>Balanced:</strong> Perfect compromise between speed & eco-impact
                                        </p>
                                    </div>
                                )}
                                
                                <div className="grid lg:grid-cols-3 gap-6">
                                    {results.map((route) => (
                                        <div 
                                            key={route.type} 
                                            className="p-5 rounded-xl shadow-xl transition"
                                            style={{
                                                backgroundColor: route.type === 'fastest' ? '#FFF1E0' : 
                                                               route.type === 'eco-friendly' ? '#E6F7E6' :
                                                               route.type === 'balanced' ? '#E0E6FF' : '#F5F5F5',
                                                border: `4px solid ${route.type === 'fastest' ? '#FF6B00' :
                                                                    route.type === 'eco-friendly' ? '#006400' :
                                                                    route.type === 'balanced' ? '#000080' : '#999'}`,
                                                boxShadow: `0 8px 16px ${route.type === 'fastest' ? '#FF6B0033' :
                                                                        route.type === 'eco-friendly' ? '#00640033' :
                                                                        route.type === 'balanced' ? '#00008033' : '#00000020'}`
                                            }}
                                        >
                                            <div className="text-center mb-3">
                                                <div className="text-4xl mb-2">
                                                    {route.type === 'fastest' || route.type === 'fast' ? 'üöÄ' :
                                                     route.type === 'eco-friendly' || route.type === 'eco' ? 'üå±' :
                                                     route.type === 'balanced' || route.type === 'rl-optimized' ? '‚öñÔ∏è' : 'üìç'}
                                                </div>
                                                <h3 className="text-xl font-extrabold"
                                                    style={{
                                                        color: route.type === 'fastest' ? '#FF6B00' :
                                                               route.type === 'eco-friendly' ? '#006400' :
                                                               route.type === 'balanced' ? '#000080' : '#666'
                                                    }}>
                                                    {route.type === 'eco-friendly' ? 'ECO FRIENDLY' : 
                                                     route.type === 'fastest' ? 'FASTEST' :
                                                     route.type.toUpperCase().replace('-', ' ')}
                                                </h3>
                                                <p className="text-sm text-gray-600 font-medium">
                                                    {route.type === 'fastest' || route.type === 'fast' ? 'Speed Optimized' :
                                                     route.type === 'eco-friendly' || route.type === 'eco' ? 'Environment First' :
                                                     route.type === 'balanced' ? 'Best Compromise' :
                                                     route.type === 'rl-optimized' ? 'AI Optimized' : 'Route Option'}
                                                </p>
                                            </div>
                                            
                                            <div className="mb-3">
                                                <p className="text-xs font-semibold text-gray-600">Green Points Score</p>
                                                <p className="text-4xl font-extrabold text-green-800">{route.green_points_score}</p>
                                            </div>
                                            
                                            <div className="grid grid-cols-2 gap-2 text-sm border-t pt-3">
                                                <div>
                                                    <p className="font-semibold text-gray-700">Time</p>
                                                    <p className="text-2xl font-bold">
                                                        {route.totalTime} <span className="text-sm">min</span>
                                                    </p>
                                                </div>
                                                <div>
                                                    <p className="font-semibold text-gray-700">CO‚ÇÇ Emissions</p>
                                                    <p className="text-2xl font-bold">
                                                        {route.totalEmissions.toLocaleString()} <span className="text-sm">g</span>
                                                    </p>
                                                </div>
                                            </div>
                                            
                                            {/* Fuel Cost Analysis */}
                                            {route.fuel_analysis && (
                                                <div className="mt-3 p-3 rounded-lg border-t-2" style={{
                                                    borderTopColor: route.type === 'fastest' ? '#FF6B00' :
                                                                  route.type === 'eco-friendly' ? '#006400' :
                                                                  route.type === 'balanced' ? '#000080' : '#999',
                                                    backgroundColor: route.type === 'fastest' ? '#FFF5F0' :
                                                                   route.type === 'eco-friendly' ? '#F0FFF0' :
                                                                   route.type === 'balanced' ? '#F0F5FF' : '#F5F5F5'
                                                }}>
                                                    <h4 style={{
                                                        color: route.type === 'fastest' ? '#FF6B00' :
                                                               route.type === 'eco-friendly' ? '#006400' :
                                                               route.type === 'balanced' ? '#000080' : '#666',
                                                        fontWeight: 'bold',
                                                        marginBottom: '8px',
                                                        fontSize: '14px'
                                                    }}>
                                                        üõ£Ô∏è Fuel Cost Analysis
                                                    </h4>
                                                    <div className="grid grid-cols-2 gap-3 text-sm">
                                                        <div>
                                                            <p className="font-semibold text-gray-600">Fuel Consumption</p>
                                                            <p className="text-xl font-bold" style={{
                                                                color: route.type === 'fastest' ? '#FF6B00' :
                                                                       route.type === 'eco-friendly' ? '#006400' :
                                                                       route.type === 'balanced' ? '#000080' : '#666'
                                                            }}>
                                                                {route.fuel_analysis.fuel_consumption_liters}L
                                                            </p>
                                                            <p className="text-xs text-gray-500">
                                                                {route.fuel_analysis.fuel_efficiency_kmpl} km/L
                                                            </p>
                                                        </div>
                                                        <div>
                                                            <p className="font-semibold text-gray-600">Fuel Cost</p>
                                                            <p className="text-xl font-bold" style={{
                                                                color: route.type === 'fastest' ? '#FF6B00' :
                                                                       route.type === 'eco-friendly' ? '#006400' :
                                                                       route.type === 'balanced' ? '#000080' : '#666'
                                                            }}>
                                                                ‚Çπ{route.fuel_analysis.fuel_cost_inr}
                                                            </p>
                                                            <p className="text-xs text-gray-500">
                                                                ‚Çπ{route.fuel_analysis.cost_per_km}/km
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                            )}
                                            
                                            {/* Detailed Route Path with Waypoints */}
                                            <div className="mt-4 p-3 bg-gray-50 rounded-lg">
                                                <p className="text-xs font-semibold text-gray-700 mb-2">üó∫Ô∏è Route Path:</p>
                                                <div className="text-xs text-gray-600">
                                                    <div className="flex flex-wrap gap-1 items-center">
                                                        {route.path.map((node, index) => (
                                                            <React.Fragment key={index}>
                                                                <span className={`px-2 py-1 rounded ${
                                                                    index === 0 ? 'bg-green-200 text-green-800 font-bold' :
                                                                    index === route.path.length - 1 ? 'bg-red-200 text-red-800 font-bold' :
                                                                    'bg-blue-100 text-blue-700 font-medium'
                                                                }`}>
                                                                    {node === '...' ? '...' : locationLabels[node] || node}
                                                                </span>
                                                                {index < route.path.length - 1 && (
                                                                    <span className="text-gray-400 mx-1">‚Üí</span>
                                                                )}
                                                            </React.Fragment>
                                                        ))}
                                                    </div>
                                                </div>
                                                {route.waypoints && route.waypoints.length > 0 && (
                                                    <div className="mt-2">
                                                        <p className="text-xs font-semibold text-gray-700 mb-1">üìç Key Waypoints:</p>
                                                        <div className="text-xs text-blue-600">
                                                            {route.waypoints.map(waypoint => locationLabels[waypoint] || waypoint).join(' ‚Ä¢ ')}
                                                        </div>
                                                    </div>
                                                )}
                                                {route.summary && (
                                                    <p className="text-xs italic text-gray-500 mt-2">{route.summary}</p>
                                                )}
                                            </div>
                                            
                                            {route.type === 'rl-optimized' && mode === 'rl' && (
                                                <p className="text-xs font-medium mt-1">
                                                    (Œ±={optimalAlpha.toFixed(3)})
                                                </p>
                                            )}
                                            
                                            {mode === 'gmaps' && (
                                                <p className="text-xs font-medium mt-1 text-blue-600">
                                                    üìç Google Maps Route
                                                </p>
                                            )}
                                        </div>
                                    ))}
                                </div>

                                {/* Fuel Cost Comparison Summary */}
                                {mode === 'gmaps' && results.length > 0 && results[0].fuel_analysis && (
                                    <div className="mt-8 bg-gradient-to-r from-orange-50 via-blue-50 to-green-50 rounded-xl p-6 border-2 border-gray-200">
                                        <h3 className="text-2xl font-bold text-gray-800 mb-6 text-center flex items-center justify-center">
                                            ‚õΩ Comprehensive Fuel Cost Analysis
                                        </h3>
                                        
                                        {/* Route Fuel Comparison Table */}
                                        <div className="grid lg:grid-cols-3 gap-4 mb-6">
                                            {results.map((route, index) => {
                                                const routeColors = {
                                                    'fastest': { bg: '#FFF1E0', border: '#FF6B00', text: '#FF6B00' },
                                                    'eco-friendly': { bg: '#F0FFF0', border: '#006400', text: '#006400' },
                                                    'balanced': { bg: '#F0F5FF', border: '#000080', text: '#000080' }
                                                };
                                                const colors = routeColors[route.type] || { bg: '#F5F5F5', border: '#999', text: '#666' };
                                                
                                                return (
                                                    <div key={route.type} 
                                                         className="p-4 rounded-lg border-2 shadow-md"
                                                         style={{ 
                                                             backgroundColor: colors.bg, 
                                                             borderColor: colors.border 
                                                         }}>
                                                        <div className="flex items-center mb-3">
                                                            <div style={{
                                                                width: '16px',
                                                                height: '16px', 
                                                                backgroundColor: colors.border,
                                                                borderRadius: '50%',
                                                                marginRight: '8px'
                                                            }}></div>
                                                            <h4 className="font-bold text-sm" style={{ color: colors.text }}>
                                                                {route.type === 'fastest' ? 'üöÄ FASTEST ROUTE' :
                                                                 route.type === 'eco-friendly' ? 'üå± ECO-FRIENDLY ROUTE' :
                                                                 route.type === 'balanced' ? '‚öñÔ∏è BALANCED ROUTE' : 'ROUTE'}
                                                            </h4>
                                                        </div>
                                                        <div className="space-y-2 text-sm">
                                                            <div className="flex justify-between">
                                                                <span className="font-medium text-gray-700">Fuel Consumption:</span>
                                                                <span className="font-bold" style={{ color: colors.text }}>
                                                                    {route.fuel_analysis.fuel_consumption_liters}L
                                                                </span>
                                                            </div>
                                                            <div className="flex justify-between">
                                                                <span className="font-medium text-gray-700">Fuel Cost:</span>
                                                                <span className="font-bold text-lg" style={{ color: colors.text }}>
                                                                    ‚Çπ{route.fuel_analysis.fuel_cost_inr}
                                                                </span>
                                                            </div>
                                                            <div className="flex justify-between">
                                                                <span className="font-medium text-gray-700">Efficiency:</span>
                                                                <span className="font-bold" style={{ color: colors.text }}>
                                                                    {route.fuel_analysis.fuel_efficiency_kmpl} km/L
                                                                </span>
                                                            </div>
                                                            <div className="flex justify-between">
                                                                <span className="font-medium text-gray-700">Cost per km:</span>
                                                                <span className="font-bold" style={{ color: colors.text }}>
                                                                    ‚Çπ{route.fuel_analysis.cost_per_km}
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>

                                        {/* Savings Comparison */}
                                        <div className="bg-white rounded-lg p-4 border border-gray-300">
                                            <h4 className="text-lg font-bold text-gray-800 mb-4 text-center">üí∞ Fuel Savings Comparison</h4>
                                            <div className="grid md:grid-cols-2 gap-4">
                                                <div className="p-3 bg-green-50 rounded-lg border border-green-200">
                                                    <h5 className="font-bold text-green-700 mb-2">üå± Eco-Friendly vs Fastest Route</h5>
                                                    {(() => {
                                                        const fastest = results.find(r => r.type === 'fastest');
                                                        const eco = results.find(r => r.type === 'eco-friendly');
                                                        const savings = fastest && eco ? (fastest.fuel_analysis.fuel_cost_inr - eco.fuel_analysis.fuel_cost_inr) : 0;
                                                        const fuelSavings = fastest && eco ? (fastest.fuel_analysis.fuel_consumption_liters - eco.fuel_analysis.fuel_consumption_liters) : 0;
                                                        return (
                                                            <div className="text-sm">
                                                                <p><strong className="text-green-600">Save ‚Çπ{savings.toFixed(2)}</strong> per trip</p>
                                                                <p><strong className="text-green-600">Save {fuelSavings.toFixed(1)}L</strong> fuel per trip</p>
                                                                <p className="text-xs text-green-600 mt-1">Monthly savings: ‚Çπ{(savings * 20).toFixed(2)} (20 trips)</p>
                                                            </div>
                                                        );
                                                    })()}
                                                </div>
                                                <div className="p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                    <h5 className="font-bold text-blue-700 mb-2">‚öñÔ∏è Balanced vs Fastest Route</h5>
                                                    {(() => {
                                                        const fastest = results.find(r => r.type === 'fastest');
                                                        const balanced = results.find(r => r.type === 'balanced');
                                                        const savings = fastest && balanced ? (fastest.fuel_analysis.fuel_cost_inr - balanced.fuel_analysis.fuel_cost_inr) : 0;
                                                        const fuelSavings = fastest && balanced ? (fastest.fuel_analysis.fuel_consumption_liters - balanced.fuel_analysis.fuel_consumption_liters) : 0;
                                                        return (
                                                            <div className="text-sm">
                                                                <p><strong className="text-blue-600">Save ‚Çπ{savings.toFixed(2)}</strong> per trip</p>
                                                                <p><strong className="text-blue-600">Save {fuelSavings.toFixed(1)}L</strong> fuel per trip</p>
                                                                <p className="text-xs text-blue-600 mt-1">Monthly savings: ‚Çπ{(savings * 20).toFixed(2)} (20 trips)</p>
                                                            </div>
                                                        );
                                                    })()}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Enhanced Multi-Vehicle Savings Dashboard */}
                                {mode === 'gmaps' && results.length > 0 && results[0].fuel_analysis && results[0].fuel_analysis.vehicle_breakdown && (
                                    <div className="mt-8 bg-gradient-to-r from-purple-50 via-indigo-50 to-blue-50 rounded-xl p-6 border-2 border-purple-200">
                                        <h3 className="text-2xl font-bold text-gray-800 mb-6 text-center flex items-center justify-center">
                                            üöó Multi-Vehicle Savings Dashboard
                                        </h3>
                                        
                                        {/* Current Vehicle Summary */}
                                        <div className="mb-6 p-4 bg-white rounded-lg border-2 border-indigo-300">
                                            <h4 className="text-lg font-bold text-indigo-700 mb-3 text-center">
                                                üéØ Your Vehicle: {selectedVehicle.charAt(0).toUpperCase() + selectedVehicle.slice(1)} Car
                                            </h4>
                                            {(() => {
                                                const currentVehicleData = results[0].fuel_analysis.vehicle_breakdown[selectedVehicle];
                                                if (!currentVehicleData) return <p>No data available for selected vehicle</p>;
                                                
                                                const fastest = results.find(r => r.type === 'fastest')?.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                const eco = results.find(r => r.type === 'eco-friendly')?.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                
                                                return (
                                                    <div className="grid md:grid-cols-3 gap-4">
                                                        <div className="text-center">
                                                            <p className="text-sm text-gray-600">Current Route Cost</p>
                                                            <p className="text-2xl font-bold text-indigo-600">‚Çπ{currentVehicleData.cost_per_trip?.toFixed(2) || 'N/A'}</p>
                                                            <p className="text-xs text-gray-500">Per trip</p>
                                                        </div>
                                                        <div className="text-center">
                                                            <p className="text-sm text-gray-600">Monthly Cost</p>
                                                            <p className="text-xl font-bold text-purple-600">‚Çπ{currentVehicleData.monthly_cost?.toFixed(0) || 'N/A'}</p>
                                                            <p className="text-xs text-gray-500">20 trips/month</p>
                                                        </div>
                                                        <div className="text-center">
                                                            <p className="text-sm text-gray-600">Annual Cost</p>
                                                            <p className="text-xl font-bold text-blue-600">‚Çπ{currentVehicleData.annual_cost?.toFixed(0) || 'N/A'}</p>
                                                            <p className="text-xs text-gray-500">240 trips/year</p>
                                                        </div>
                                                    </div>
                                                );
                                            })()}
                                        </div>

                                        {/* Route Comparison for Current Vehicle */}
                                        <div className="grid lg:grid-cols-3 gap-4 mb-6">
                                            {results.map((route, index) => {
                                                const routeColors = {
                                                    'fastest': { bg: '#FFF1E0', border: '#FF6B00', text: '#FF6B00', icon: 'üöÄ' },
                                                    'eco-friendly': { bg: '#F0FFF0', border: '#006400', text: '#006400', icon: 'üå±' },
                                                    'balanced': { bg: '#F0F5FF', border: '#000080', text: '#000080', icon: '‚öñÔ∏è' }
                                                };
                                                const colors = routeColors[route.type] || { bg: '#F5F5F5', border: '#999', text: '#666', icon: 'üìç' };
                                                const vehicleData = route.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                
                                                if (!vehicleData) return null;
                                                
                                                return (
                                                    <div key={route.type} 
                                                         className="p-4 rounded-lg border-2 shadow-lg transform hover:scale-105 transition-transform"
                                                         style={{ 
                                                             backgroundColor: colors.bg, 
                                                             borderColor: colors.border 
                                                         }}>
                                                        <div className="text-center mb-3">
                                                            <h4 className="font-bold text-sm" style={{ color: colors.text }}>
                                                                {colors.icon} {route.type.toUpperCase().replace('-', ' ')} ROUTE
                                                            </h4>
                                                        </div>
                                                        <div className="space-y-2 text-sm">
                                                            <div className="text-center">
                                                                <p className="text-xs text-gray-600">Trip Cost</p>
                                                                <p className="text-xl font-bold" style={{ color: colors.text }}>
                                                                    ‚Çπ{vehicleData.cost_per_trip?.toFixed(2) || 'N/A'}
                                                                </p>
                                                            </div>
                                                            <div className="text-center">
                                                                <p className="text-xs text-gray-600">Consumption</p>
                                                                <p className="text-sm font-bold" style={{ color: colors.text }}>
                                                                    {vehicleData.consumption?.toFixed(2) || 'N/A'} {vehicleData.unit || 'L'}
                                                                </p>
                                                            </div>
                                                            <div className="text-center">
                                                                <p className="text-xs text-gray-600">Monthly</p>
                                                                <p className="text-sm font-bold" style={{ color: colors.text }}>
                                                                    ‚Çπ{vehicleData.monthly_cost?.toFixed(0) || 'N/A'}
                                                                </p>
                                                            </div>
                                                        </div>
                                                    </div>
                                                );
                                            })}
                                        </div>

                                        {/* Savings Analysis for Current Vehicle */}
                                        <div className="bg-white rounded-lg p-4 border border-gray-300 mb-6">
                                            <h4 className="text-lg font-bold text-gray-800 mb-4 text-center">üí∞ Your Potential Savings</h4>
                                            <div className="grid md:grid-cols-2 gap-4">
                                                {(() => {
                                                    const fastest = results.find(r => r.type === 'fastest')?.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                    const eco = results.find(r => r.type === 'eco-friendly')?.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                    const balanced = results.find(r => r.type === 'balanced')?.fuel_analysis?.vehicle_breakdown?.[selectedVehicle];
                                                    
                                                    return (
                                                        <>
                                                            {fastest && eco && (
                                                                <div className="p-3 bg-green-50 rounded-lg border border-green-200">
                                                                    <h5 className="font-bold text-green-700 mb-2">üå± Eco vs Fastest Route</h5>
                                                                    <div className="text-sm">
                                                                        <p><strong className="text-green-600">Save ‚Çπ{(fastest.cost_per_trip - eco.cost_per_trip).toFixed(2)}</strong> per trip</p>
                                                                        <p><strong className="text-green-600">Monthly: ‚Çπ{(fastest.monthly_cost - eco.monthly_cost).toFixed(0)}</strong></p>
                                                                        <p><strong className="text-green-600">Annual: ‚Çπ{(fastest.annual_cost - eco.annual_cost).toFixed(0)}</strong></p>
                                                                    </div>
                                                                </div>
                                                            )}
                                                            {fastest && balanced && (
                                                                <div className="p-3 bg-blue-50 rounded-lg border border-blue-200">
                                                                    <h5 className="font-bold text-blue-700 mb-2">‚öñÔ∏è Balanced vs Fastest Route</h5>
                                                                    <div className="text-sm">
                                                                        <p><strong className="text-blue-600">Save ‚Çπ{(fastest.cost_per_trip - balanced.cost_per_trip).toFixed(2)}</strong> per trip</p>
                                                                        <p><strong className="text-blue-600">Monthly: ‚Çπ{(fastest.monthly_cost - balanced.monthly_cost).toFixed(0)}</strong></p>
                                                                        <p><strong className="text-blue-600">Annual: ‚Çπ{(fastest.annual_cost - balanced.annual_cost).toFixed(0)}</strong></p>
                                                                    </div>
                                                                </div>
                                                            )}
                                                        </>
                                                    );
                                                })()}
                                            </div>
                                        </div>

                                        {/* Multi-Vehicle Comparison Matrix */}
                                        <div className="bg-white rounded-lg p-4 border border-gray-300">
                                            <h4 className="text-lg font-bold text-gray-800 mb-4 text-center">üöó Compare All Vehicle Types</h4>
                                            {(() => {
                                                const vehicleBreakdown = results[0].fuel_analysis?.vehicle_breakdown;
                                                if (!vehicleBreakdown) return <p>No vehicle comparison data available</p>;
                                                
                                                const vehicleTypes = ['petrol', 'diesel', 'cng', 'electric', 'hybrid'];
                                                const vehicleNames = {
                                                    'petrol': 'Petrol Car',
                                                    'diesel': 'Diesel Car', 
                                                    'cng': 'CNG Car',
                                                    'electric': 'Electric Car',
                                                    'hybrid': 'Hybrid Car'
                                                };
                                                
                                                return (
                                                    <div className="overflow-x-auto">
                                                        <table className="w-full text-sm">
                                                            <thead className="bg-gray-100">
                                                                <tr>
                                                                    <th className="p-2 text-left font-bold">Vehicle Type</th>
                                                                    <th className="p-2 text-center font-bold">Per Trip</th>
                                                                    <th className="p-2 text-center font-bold">Monthly</th>
                                                                    <th className="p-2 text-center font-bold">Annual</th>
                                                                    <th className="p-2 text-center font-bold">Best Route</th>
                                                                </tr>
                                                            </thead>
                                                            <tbody>
                                                                {vehicleTypes.map(vehicleType => {
                                                                    const vehicleData = vehicleBreakdown[vehicleType];
                                                                    if (!vehicleData) return null;
                                                                    
                                                                    const isSelected = vehicleType === selectedVehicle;
                                                                    
                                                                    return (
                                                                        <tr key={vehicleType} className={isSelected ? 'bg-blue-50 border-2 border-blue-300' : 'border-b'}>
                                                                            <td className="p-2 font-medium">
                                                                                {isSelected && 'üëâ '}{vehicleNames[vehicleType]}
                                                                            </td>
                                                                            <td className="p-2 text-center font-bold">‚Çπ{vehicleData.cost_per_trip?.toFixed(2) || 'N/A'}</td>
                                                                            <td className="p-2 text-center font-bold">‚Çπ{vehicleData.monthly_cost?.toFixed(0) || 'N/A'}</td>
                                                                            <td className="p-2 text-center font-bold">‚Çπ{vehicleData.annual_cost?.toFixed(0) || 'N/A'}</td>
                                                                            <td className="p-2 text-center">
                                                                                <span className="px-2 py-1 rounded text-xs font-bold bg-green-100 text-green-700">
                                                                                    ECO-FRIENDLY
                                                                                </span>
                                                                            </td>
                                                                        </tr>
                                                                    );
                                                                })}
                                                            </tbody>
                                                        </table>
                                                    </div>
                                                );
                                            })()}
                                        </div>
                                    </div>
                                )}

                                {/* Google Maps Optimization Insights */}
                                {mode === 'gmaps' && results.length > 0 && (
                                    <div className="mt-8 bg-gradient-to-r from-blue-50 to-green-50 rounded-xl p-6 border border-blue-200">
                                        <h3 className="text-xl font-bold text-gray-800 mb-4 flex items-center justify-center">
                                            üí° Smart Route Insights & Recommendations
                                        </h3>
                                        <div className="grid md:grid-cols-2 gap-4">
                                            <div className="bg-white rounded-lg p-4 shadow-sm">
                                                <h4 className="font-semibold text-green-700 mb-2 flex items-center">
                                                    üå± Environmental Impact
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Eco-friendly route saves <strong className="text-green-600">
                                                    {Math.abs((results.find(r => r.type === 'fastest')?.totalEmissions || 0) - 
                                                              (results.find(r => r.type === 'eco-friendly')?.totalEmissions || 0))} grams CO‚ÇÇ</strong> compared to fastest route
                                                </p>
                                                <p className="text-xs text-green-600 mt-1 font-medium">
                                                    üíö Choose eco-friendly for sustainable travel
                                                </p>
                                            </div>
                                            <div className="bg-white rounded-lg p-4 shadow-sm">
                                                <h4 className="font-semibold text-blue-700 mb-2 flex items-center">
                                                    ‚è±Ô∏è Time Comparison
                                                </h4>
                                                <p className="text-sm text-gray-600">
                                                    Balanced route is only <strong className="text-blue-600">
                                                    {Math.abs((results.find(r => r.type === 'balanced')?.totalTime || 0) - 
                                                              (results.find(r => r.type === 'fastest')?.totalTime || 0))} minutes slower</strong> than fastest
                                                </p>
                                                <p className="text-xs text-blue-600 mt-1 font-medium">
                                                    ‚öñÔ∏è Best overall value for most trips
                                                </p>
                                            </div>
                                        </div>
                                        <div className="mt-4 p-3 bg-yellow-100 rounded-lg border border-yellow-300">
                                            <p className="text-sm text-yellow-800">
                                                <strong>üí° Pro Tip:</strong> Consider traffic patterns! Departing 30 minutes later could save you 10-15 minutes in heavy traffic.
                                            </p>
                                        </div>
                                        
                                        {/* Route Comparison Summary */}
                                        <div className="mt-4 bg-white rounded-lg shadow-sm overflow-hidden">
                                            <div className="px-4 py-3 bg-gray-50 border-b">
                                                <h4 className="font-semibold text-gray-800">üìä Quick Comparison</h4>
                                            </div>
                                            <div className="p-4">
                                                <div className="grid grid-cols-3 gap-4 text-center">
                                                    {results.map((route) => (
                                                        <div key={route.type} className="text-sm">
                                                            <div className="font-semibold text-gray-700 mb-1">
                                                                {route.type === 'fastest' ? 'üöÄ Fastest' :
                                                                 route.type === 'eco-friendly' ? 'üå± Eco-Friendly' :
                                                                 '‚öñÔ∏è Balanced'}
                                                            </div>
                                                            <div className="text-xs text-gray-600">
                                                                {route.totalTime}min ‚Ä¢ {Math.round(route.totalEmissions/1000)}kg CO‚ÇÇ
                                                            </div>
                                                            <div className={`mt-1 px-2 py-1 rounded text-xs font-medium ${
                                                                route.green_points_score >= 80 ? 'bg-green-100 text-green-700' :
                                                                route.green_points_score >= 60 ? 'bg-yellow-100 text-yellow-700' : 
                                                                'bg-red-100 text-red-700'
                                                            }`}>
                                                                Score: {Math.round(route.green_points_score/10)}/10
                                                            </div>
                                                        </div>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                )}

                                {/* Google Maps Visualization */}
                                {mode === 'gmaps' && results && results.length > 0 && (
                                    <GoogleMapsComponent 
                                        routes={results} 
                                        origin={locationLabels[startNode]}
                                        destination={locationLabels[endNode]}
                                    />
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>